"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[8228],{7106:(e,a,t)=>{t.r(a),t.d(a,{FeatureActivationShelf:()=>xe});var n=t(67294),i=t(51615),s=t(69518),l=t.n(s),o=t(87577),r=t(17728),c=t(96206),u=t(32667),d=t(74257),h=t(28230),g=t(52208),m=t(94184),f=t.n(m),p=t(98522),y=t(89104);const v="uDOC2Oah0jn_p7N7l2Id",C="hwhquP1FOxRcCnf84P2M",x="bijDFKtWL1TJBF7X9Gp3",b="NTywvDEuW1PlcoR__9XV",j="t1SDLPBbSPbfihznNZdi",N="CvyMWBz1l8dSOsf4r_Ha",S="R32cBJPV9ccjWJYS1TLI",E="fzmowfLpLz7UlIyJThU8",k="MIBwSRJ5XZaCw1WWXXBn",w="dEuzpK3s_BmlRiVNFude",L="MVRnUhNC4ZMglLR56YMn",F="xiaMaZPt8ykPGR8gkQ53",P="mwBKJFOe7ee6V2MdmJyB",A="LziKPm9lTkWR0I7zD_rC";var I=t(85893);const _=n.memo((function({image:e}){return(0,I.jsx)("div",{className:x,children:(0,I.jsx)("div",{className:b,children:(0,I.jsx)(y.E,{className:j,src:e,loading:"lazy"})})})}));var B=t(22247),R=t(96001);const D="mKkYwwDvRoTIEnqf9Mlt",T="ES02HhKmADP_AdcKPs1e",U="IYwEYGRUJ5RTtr0EyBV1",z="YYlv5PB5fGQthi9XzTQg",W=n.memo((({isLoading:e})=>{const a=(0,R.h)("shimmer");return(0,I.jsx)("div",{ref:a,className:f()(b,{[z]:e})})})),M=n.memo((({cardImage:e,isLoading:a})=>(0,I.jsxs)("div",{className:f()(C,D),"aria-hidden":!0,children:[(0,I.jsx)("div",{className:x,children:e||(0,I.jsx)(W,{isLoading:a})}),(0,I.jsx)("div",{className:N,children:(0,I.jsxs)("div",{className:S,children:[(0,I.jsx)(B.C,{as:"div",variant:"balladBold",className:T,charCount:10,isLoading:a}),(0,I.jsx)(B.C,{as:"div",variant:"mesto",className:U,charCount:15,isLoading:a})]})})]}))),V=n.memo((function({children:e,image:a,isLoading:t,onClick:n,id:i}){return t?(0,I.jsx)(M,{isLoading:!0}):(0,I.jsxs)("div",{className:f()(C),onClick:n,children:[(0,I.jsx)(_,{image:a}),(0,I.jsx)("div",{className:N,children:(0,I.jsx)("div",{className:S,children:(0,I.jsxs)("div",{className:E,children:[(0,I.jsx)(p.D,{color:getComputedStyle(document.body).getPropertyValue("--spice-text").trim(),height:"18",className:k}),e]})})}),(0,I.jsx)("div",{"data-testid":i,onClick:n,className:v})]})})),Q="https://newsroom.spotify.com/2021-09-09/get-perfect-song-recommendations-in-the-playlists-you-create-with-enhance/",J=n.memo((function({isLoading:e=!1,spec:a,logger:t}){const{openURL:i}=(0,g.e)();(0,n.useEffect)((()=>{t.logImpression(a.shelfContainerFactory().enchanceCardFactory().impression())}),[a,t]);const s=(0,n.useCallback)((e=>{e.stopPropagation(),t.logInteraction(a.shelfContainerFactory().enchanceCardFactory().hitNavigateToExternalUri({destination:Q})),i(Q)}),[i,a,t]);return(0,I.jsxs)(V,{image:(0,h.g)("images/feature-activation-shelf-enhance-placeholder.png"),isLoading:e,onClick:s,children:[(0,I.jsx)(u.D,{as:"p",variant:"balladBold",className:w,children:c.ag.get("web-player.feature-activation-shelf.enhance-placeholder.title")}),(0,I.jsx)(u.D,{as:"p",variant:"mesto",className:L,children:c.ag.get("web-player.feature-activation-shelf.enhance.description")}),(0,I.jsx)(d.P,{className:F,buttonSize:"sm",onClick:s,children:c.ag.get("web-player.feature-activation-shelf.enhance-placeholder.cta")})]})}));var q=t(11680),G=t(72138),O=t(72989),H=t(9659);function K({items:e}){return e.filter(H.no).find((e=>e.isOwnedBySelf&&e.totalLength>0))??null}const Y={offset:0,limit:50,flatten:!0,sort:{field:H.bD.RELEVANCE,order:H.As.DESC}};var X=t(49207),Z=t(15852),$=t(72603),ee=t(69846);const ae=n.memo((function({isLoading:e=!1,playlist:a,toggleEnhanceState:t,navigateToPlaylist:i,spec:s,logger:l}){const{isEnhanced:o}=(0,ee.U)(a.metadata.uri);(0,n.useEffect)((()=>{l.logImpression(s.shelfContainerFactory().enchanceCardFactory().impression())}),[s,l]);const r=(0,n.useCallback)((()=>{l.logInteraction(s.shelfContainerFactory().enchanceCardFactory().hitEnhancePlaylist({playlist:a.metadata.uri})),i(a.metadata.uri),o||t()}),[t,o,a.metadata.uri,i,l,s]);return(0,I.jsxs)(V,{image:a.metadata.images[0].url,isLoading:e,onClick:r,children:[(0,I.jsx)(u.D,{as:"p",variant:"balladBold",className:w,children:c.ag.get("web-player.feature-activation-shelf.enhance.title",{playlist:a.metadata.name})}),(0,I.jsx)(u.D,{as:"p",variant:"mesto",className:L,children:c.ag.get("web-player.feature-activation-shelf.enhance.description")}),(0,I.jsx)(d.P,{className:f()(F,{[P]:o}),buttonSize:"sm",iconLeading:$.e,onClick:r,children:o?c.ag.get("web-player.feature-activation-shelf.enhance.cta-enhanced"):c.ag.get("web-player.feature-activation-shelf.enhance.cta")})]})}));var te=t(53107);const ne=n.memo((function({isLoading:e=!1,spec:a,logger:t}){const{setVisible:i}=(0,n.useContext)(te.O);(0,n.useEffect)((()=>{t.logImpression(a.shelfContainerFactory().groupSessionsCardFactory().impression())}),[a,t]);const s=()=>{t.logInteraction(a.shelfContainerFactory().groupSessionsCardFactory().hitUiReveal()),i(!0)};return(0,I.jsxs)(V,{image:(0,h.g)("images/feature-activation-shelf-group-sessions.png"),isLoading:e,onClick:s,children:[(0,I.jsx)(u.D,{as:"p",variant:"balladBold",className:w,children:c.ag.get("web-player.feature-activation-shelf.group-sessions.title")}),(0,I.jsx)(u.D,{as:"p",variant:"mesto",className:L,children:c.ag.get("web-player.feature-activation-shelf.group-sessions.description")}),(0,I.jsx)(d.P,{className:F,buttonSize:"sm",onClick:s,children:c.ag.get("web-player.feature-activation-shelf.group-sessions.cta")})]})}));var ie=t(28066),se=t(75102),le=t(55400);const oe=n.memo((function({isLoading:e=!1,spec:a,logger:t}){const s=(0,i.k6)(),{isAvailable:l,isEnabled:o,enableVeryHighQualityAudio:r}=(()=>{const{settings:{values:e},setValue:a}=(0,le.r)(),t=e["audio.play_bitrate_enumeration"];return{isAvailable:!!t&&(0,se.kN)(t.toString(),e)&&(0,se.gj)(e),isEnabled:t===se.PF.veryhigh.enum.toString(),enableVeryHighQualityAudio:()=>{a("audio.play_bitrate_non_metered_enumeration",se.PF.veryhigh.enum),a("audio.play_bitrate_enumeration",se.PF.veryhigh.enum)}}})();(0,n.useEffect)((()=>{l&&t.logImpression(a.shelfContainerFactory().audioQualityCardFactory().impression())}),[a,t,l]);const g=e=>{const n="/preferences"+(e?`?${e}`:"");t.logInteraction(a.shelfContainerFactory().audioQualityCardFactory().hitUiNavigate({destination:n})),s.push(n)},m=()=>{t.logInteraction(a.shelfContainerFactory().audioQualityCardFactory().hitSetSettingField()),r(),g("feature-activation")};return l?(0,I.jsxs)(V,{image:(0,h.g)("images/feature-activation-shelf-audio-quality.png"),isLoading:e,id:"audio-quality-card",onClick:o?()=>g():m,children:[(0,I.jsx)(u.D,{as:"p",variant:"balladBold",className:w,children:c.ag.get("web-player.feature-activation-shelf.audio-quality.title")}),(0,I.jsx)(u.D,{as:"p",variant:"mesto",className:L,children:c.ag.get("web-player.feature-activation-shelf.audio-quality.description")}),(0,I.jsx)(d.P,{className:f()(F,{[A]:o}),onClick:o?()=>g():m,buttonSize:"sm",iconLeading:o?ie.N:void 0,children:o?c.ag.get("web-player.feature-activation-shelf.audio-quality.cta_alt"):c.ag.get("web-player.feature-activation-shelf.audio-quality.cta")})]}):null}));var re=t(24391),ce=t(13218),ue=t(27937),de=t(85951);const he="RvSsw_CWBCtHhojt6bY_",ge=n.memo(n.forwardRef((function(e,a){const{className:t,render:i}=e,s=(0,n.useRef)(null),[l,o]=(0,n.useState)({columnCount:-1,columnWidth:-1,gridGap:24});(0,n.useImperativeHandle)(a,(()=>s.current));const r=(0,n.useCallback)((()=>{const e=s.current;if(!e||!e.parentElement)return;const a=e.parentElement.offsetWidth,t=(e=>e<700?1:e<1e3?2:3)(a),n=(e=>2===e?12:3===e?18:24)(t),i=Math.floor((a-(t-1)*n)/t);o({columnCount:t,columnWidth:i,gridGap:n})}),[]);(0,de.y)({refOrElement:s,observeOnly:"width",onResize:()=>{r()}}),(0,n.useLayoutEffect)((()=>{r()}),[r]);const c={"--column-width":`${l.columnWidth}px`,"--column-count":`${l.columnCount}`,"--grid-gap":`${l.gridGap}px`};return(0,I.jsx)("div",{ref:s,className:f()(he,t),style:c,children:i(l)})})));ge.displayName="GridContainer";const me="QD8u8vCxcfIpJC14IBqg",fe="H4yLgZB7CQJlPH3u5Qbi",pe="jNsZ_X7AAz13oxU5Sx0G",ye=n.memo((function({title:e,children:a,seeAllUri:t,className:i="",testId:s="component",seeAllLabel:l,onClickShelfTitle:o,onClickShelfSeeAll:r,elementRef:c}){const u=(0,n.useCallback)((({columnCount:e})=>(0,I.jsx)(I.Fragment,{children:Array.isArray(a)&&a.filter(((a,t)=>t<e))})),[a]);return Array.isArray(a)&&0===a.length?null:(0,I.jsxs)("section",{ref:c,className:f()(i,me),"data-testid":`${s}-shelf`,"aria-label":e,children:[(0,I.jsx)("div",{className:fe,children:(0,I.jsx)(ce.r,{title:e,seeAllUri:t,seeAllLabel:l,hasMoreElements:!0,onClickTitle:o,onClickSeeAll:r})}),(0,I.jsx)(ge,{className:f()(pe),render:u})]})}));ye.displayName="BaseShelf";const ve=e=>(0,I.jsx)(re.L,{onError:e=>{(0,ue.vK)(e,"Shelf")},children:(0,I.jsx)(ye,{...e})}),Ce="https://support.spotify.com/us/article/premium-plans/",xe=n.memo((function(){const{loading:e,error:a,toggleEnhanceState:t,playlistWithEnhanceState:s}=function(){const e=(0,O.o)(),a=(0,q._)(),t=(0,n.useContext)(G.ZF),i=(0,n.useMemo)((()=>function(e){return async function(a){if(null===a)return null;try{const t=await e.getPlaylist(a.uri);return t.metadata.hasSpotifyTracks?t:null}catch(e){return null}}}(t)),[t]),s=(0,n.useMemo)((()=>function(e){return async function(a){if(null===a)return null;try{const{isEnhanced:t}=await e.getContextState(a.metadata.uri);return{...a,isEnhanced:t}}catch(e){return null}}}(a)),[a]),[l,o]=(0,n.useState)(null),[r,c]=(0,n.useState)(!1),[u,d]=(0,n.useState)(null);(0,n.useEffect)((()=>{c(!0),e.getContents(Y).then(K).then(i).then(s).then(o).catch(d).finally((()=>c(!1)))}),[e,i,s]);const h=(0,n.useCallback)((()=>null===l?Promise.reject("No playlist found."):a.getContextState(l.metadata.uri).then((e=>a.setIsEnhanced(l.metadata.uri,!e.isEnhanced)))),[l,a]);return{loading:r,playlistWithEnhanceState:l,toggleEnhanceState:h,error:u}}(),u=(0,i.k6)(),{spec:d,logger:h}=(0,Z.fU)(r.createDesktopFeatureActivationShelfEventFactory,{});(0,n.useEffect)((()=>{h.logImpression(d.shelfContainerFactory().impression())}),[d,h]);const g=(0,n.useCallback)((e=>{const a=l().from(e).toURLPath(!0);u.push(a)}),[u]),m=null!==s&&!a,f=(0,n.useCallback)((()=>{h.logInteraction(d.shelfTitleFactory().hitNavigateToExternalUri({destination:Ce}))}),[d,h]),p=(0,n.useCallback)((()=>{h.logInteraction(d.seeAllFeaturesFactory().hitNavigateToExternalUri({destination:Ce}))}),[d,h]),y=(0,o.W6)(X.Up,{loadingValue:!1});return(0,I.jsxs)(ve,{seeAllUri:Ce,title:c.ag.get("web-player.feature-activation-shelf.title"),seeAllLabel:c.ag.get("web-player.feature-activation-shelf.see_more"),onClickShelfTitle:f,onClickShelfSeeAll:p,children:[y&&(m?(0,I.jsx)(ae,{playlist:s,isLoading:e,toggleEnhanceState:t,navigateToPlaylist:g,spec:d,logger:h}):(0,I.jsx)(J,{isLoading:e,spec:d,logger:h})),(0,I.jsx)(ne,{isLoading:e,spec:d,logger:h}),(0,I.jsx)(oe,{isLoading:e,spec:d,logger:h})]})}))}}]);
//# sourceMappingURL=xpui-feature-activation-shelf.js.map