"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[7704],{11169:(e,t,n)=>{n.r(t),n.d(t,{SKELETON_CARDS_COUNT:()=>Bt,SKELETON_SHELVES_COUNT:()=>Pt,SKELETON_SHORTCUTS_COUNT:()=>wt,default:()=>Ut});var s=n(67294),r=n(94184),o=n.n(r),i=n(73526),a=n(96206),l=n(70369),c=n(22247),u=n(24391),m=n(69559),d=n(27937),h=n(42781),x=n(4236),f=n(13218),g=n(70296),p=n(69518),j=n.n(p),C=n(24524),S=n(86250),y=n(39278),v=n(61251),k=n(18261),N=n(4232),b=n(80507),T=n(25988),L=n(35410),E=n(86514),_=n(97081),w=n(20006),P=n(26482),B=n(19986),I=n(52759),A=n(69691);const U="view-homeShortcutsGrid-shortcuts",R="view-homeShortcutsGrid-grid",O="view-homeShortcutsGrid-shortcutLink",D="view-homeShortcutsGrid-shortcut",F="view-homeShortcutsGrid-draggable",M="view-homeShortcutsGrid-imageContainer",H="view-homeShortcutsGrid-imageWrapper",z="view-homeShortcutsGrid-image",G="view-homeShortcutsGrid-main",W="view-homeShortcutsGrid-nameWrapper",Z="view-homeShortcutsGrid-name",q="EzRmGRncgnv1zFgF4dqE",K="bPmmKmSPLKMhtJSaUJRX",V="vpQWUBWS_lXRLZMRJT7w",J="GSv7K805J9Jw7LB9tn2A",Y="view-homeShortcutsGrid-PlayButtonContainer",$="s9c9x_mJq197U2hBzGtV";var X=n(85893);const Q=(0,s.memo)((function({item:e}){const t=(0,B._)(e.uri),n=e.duration_ms??0,{isPlaying:s,isActive:r}=(0,A.$o)(e.uri),[o]=(0,I.z)(1e4,(t=>t.item?.uri===e.uri)),i=e.resume_point?.resume_position_ms??0,a=s||r?o:i,l=Math.round(100/(n/a)),c=t===P.Om.YES,u=n&&a>0;return c||u?(0,X.jsxs)("div",{className:V,children:[c?(0,X.jsx)(_.E,{iconSize:16,semanticColor:"textSubdued"}):null,u?(0,X.jsx)(w.k,{className:J,value:l,semanticColor:"essentialBase"}):null]}):null}));var ee=n(51615),te=n(32667),ne=n(43864),se=n(82627),re=n(91355),oe=n(84242),ie=n(15852),ae=n(57784),le=n(26492),ce=n(67892),ue=n(89104),me=n(49961);const de=(0,s.memo)((function({images:e=[],fallbackIcon:t=C.U}){const n=(0,me.X)(e);return(0,X.jsx)("div",{className:M,children:(0,X.jsx)("div",{className:H,children:(0,X.jsx)(ue.E,{className:z,src:n?.url,loading:"lazy",testid:"shortcut-image",children:(0,X.jsx)(t,{"aria-hidden":!0})})})})})),he=s.memo((function({index:e,item:t,fallbackIcon:n,showPlayButton:r,extraContent:i,onContextMenu:a=(()=>{}),onTouchStart:l=(()=>{}),onTouchEnd:c=(()=>{})}){const u=(0,ee.k6)(),m=(0,le.o)(),{setColorFromUri:d,resetColor:h,clearColor:x}=(0,g.WQ)(),f=(0,re.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:p,logger:C}=(0,ie.fU)(ne.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:S,isActive:y,togglePlay:v}=(0,oe.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});const k=(0,s.useCallback)((()=>{m({targetUri:t.uri,intent:"navigate",type:"click"});const e=p.hitUiNavigate({destination:t.uri});C.logInteraction(e),u.push(j().from(t.uri).toURLPath(!0))}),[u,t.uri,C,m,p]),N=(0,s.useCallback)((()=>{d(t.uri)}),[t.uri,d]);(0,s.useEffect)((()=>()=>{x()}),[x]);const b=(0,ie.Wi)(p),T=(0,ae.O1)([t.uri],t.name);return(0,X.jsx)("div",{ref:b,className:D,onContextMenu:a,onTouchStart:l,onTouchEnd:c,onMouseEnter:N,onMouseLeave:h,children:(0,X.jsxs)("div",{className:F,onDragStart:T,children:[(0,X.jsx)(de,{images:t.images,fallbackIcon:n}),(0,X.jsxs)("div",{className:G,children:[(0,X.jsxs)("div",{className:W,children:[(0,X.jsxs)("div",{className:Z,children:[f&&(0,X.jsx)(re.Rd,{className:K}),(0,X.jsx)(ce.r,{to:t.uri,onClick:k,title:t.name,children:(0,X.jsx)(te.D,{as:"p",variant:"balladBold",className:q,children:t.name})})]}),i||null]}),r&&(0,X.jsx)("div",{className:o()(Y,{[$]:S}),children:(0,X.jsx)(se.f,{isPlaying:S,onClick:function(){m({targetUri:t.uri,intent:S?"pause":"play",type:"click"});const e=p.playButtonFactory();let n;n=S?e.hitPause({itemToBePaused:t.uri}):y?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const s=C.logInteraction(n);v({loggingParams:s})}})})]}),(0,X.jsx)("div",{onClick:k,className:O})]})})})),xe=s.memo((function(e){return j().isCollection(e.item.uri)?(0,X.jsx)(he,{...e,fallbackIcon:C.U}):(0,X.jsx)(k._,{menu:(0,X.jsx)(L.X,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:C.U})})})),fe=s.memo((function(e){return(0,X.jsx)(k._,{menu:(0,X.jsx)(N.Y,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:S.c})})})),ge=s.memo((function(e){return(0,X.jsx)(k._,{menu:(0,X.jsx)(b.m,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:y.a})})})),pe=s.memo((function(e){return(0,X.jsx)(k._,{menu:(0,X.jsx)(E.M,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:v.J,showPlayButton:!1})})})),je=s.memo((function(e){return e.item.podcast?(0,X.jsx)(pe,{index:e.index,shouldSetBackgroundColor:e.shouldSetBackgroundColor,item:e.item.podcast,showPlayButton:e.showPlayButton}):(0,X.jsx)(k._,{menu:(0,X.jsx)(T.k,{uri:e.item.uri}),children:(0,X.jsx)(he,{...e,fallbackIcon:v.J,extraContent:(0,X.jsx)(Q,{...e})})})}));var Ce=n(11436),Se=n(49068);const ye="J6UEDIqMSJhYlwGoeUZB",ve="ZjFf4lVC48DSryAjP9qB",ke=s.memo((function(e){const t=(0,Se.x)(),n={...e.item,...t};return(0,X.jsx)(he,{...e,item:n,fallbackIcon:()=>(0,X.jsx)("div",{className:ye,children:(0,X.jsx)(Ce.P,{iconSize:32,className:ve})})})})),Ne=24,be=270;function Te(e){if(null===e)return{cssProperties:{"--min-column-width":"270px","--item-height":"80px","--column-gap":"24px","--row-gap":"16px"},showPlayButton:!0};const t=e.offsetWidth,n=t<600?200:be;const s=Math.min(Math.floor((t+Ne)/(n+Ne)),3),r=t>=858?80:64;return{cssProperties:{"--min-column-width":`${n}px`,"--item-height":`${r}px`,"--column-gap":"24px","--row-gap":`${64===r?12:16}px`},showPlayButton:(t-(s-1)*Ne)/s>=be}}function Le(){const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(Te(null)),r=(0,s.useCallback)((()=>{null!==e.current&&n(Te(e.current))}),[]),o=(0,s.useCallback)((t=>{e.current=t,r()}),[r]);return(0,m.a)((()=>r())),[t,o]}const Ee=s.memo((function({title:e,tagline:t,items:n}){const{fetchMultipleColors:r}=(0,g.WQ)(),o=!(0,x.k)(),i=e??(()=>{const e=(new Date).getHours();let t=a.ag.get("home.evening");return e>=5&&e<12?t=a.ag.get("home.morning"):e>=12&&e<18&&(t=a.ag.get("home.afternoon")),t})(),[l,c]=Le();return(0,s.useEffect)((()=>{const e=n?.map(g.lh)||[];r(e)}),[n,r]),o||!n?.length?null:(0,X.jsxs)("section",{className:U,"aria-label":i,ref:c,children:[(0,X.jsx)(f.r,{title:i,titleVariant:"alto",tagline:t}),(0,X.jsx)("div",{className:R,style:l.cssProperties,children:n.filter(((e,t)=>t<6)).map(((e,t)=>{if((e=>{if(null!==e&&"object"==typeof e){const{type:t,name:n}=e;return t===h.p.YOUR_EPISODES&&"string"==typeof n}return!1})(e))return(0,X.jsx)(ke,{index:t,item:e,showPlayButton:l.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`);const n=function(e){const t=(j().from(e)||{}).type;switch(t){case j().Type.ARTIST:return ge;case j().Type.ALBUM:case j().Type.COLLECTION_ALBUM:return fe;case j().Type.PLAYLIST:case j().Type.PLAYLIST_V2:return xe;case j().Type.SHOW:return pe;case j().Type.EPISODE:return je;case j().Type.COLLECTION:return xe;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),pe}}(e.uri);return(0,X.jsx)(n,{index:t,item:e,showPlayButton:l.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`)}))})]})})),_e=e=>(0,X.jsx)(u.L,{onError:e=>{(0,d.vK)(e,"HomeShortcutsGrid")},children:(0,X.jsx)(Ee,{...e})});var we=n(96001);const Pe="zUf7jtv9GPOKC1jYO5TO",Be="T8QLel3PoQTgJUpGYj7Q",Ie=(0,s.memo)((({isLoading:e})=>{const t=(0,we.h)("shimmer");return(0,X.jsx)("div",{className:M,children:(0,X.jsx)("div",{ref:t,className:o()(H,{[Be]:e})})})})),Ae=(0,s.memo)((({isLoading:e})=>(0,X.jsx)("div",{className:o()(D,Pe),"data-testid":"skeleton-shortcut",children:(0,X.jsxs)("div",{className:F,children:[(0,X.jsx)(Ie,{isLoading:e}),(0,X.jsx)("div",{className:G,children:(0,X.jsx)(c.C,{as:"p",variant:"balladBold",className:q,isLoading:e})})]})}))),Ue="v7dc5ekmeBiAYnLzV8oT",Re=(0,s.memo)((({shortcutCount:e})=>{const[t,n]=Le();return(0,X.jsxs)("section",{className:U,ref:n,children:[(0,X.jsx)(c.C,{as:"h2",variant:"alto",className:Ue,charCount:25,isLoading:!0}),(0,X.jsx)("div",{className:R,style:t.cssProperties,children:[...new Array(e).keys()].slice(0,6).map(((e,t)=>(0,X.jsx)(Ae,{isLoading:!0},t)))})]})}));var Oe=n(6158),De=n(13983),Fe=n(87577),Me=n(49207),He=n(28638),ze=n(62572);const Ge=()=>(0,Fe.W6)(Me.Jw)===Me.pF.ONHOME?(0,X.jsx)(He.w,{children:(0,X.jsx)(ze.M,{onSearch:!1})}):null;var We=n(81993),Ze=n(29393),qe=n(41092),Ke=n(87194),Ve=n(47094),Je=n(38470),Ye=n(86868),$e=n(48817),Xe=n(98197),Qe=n(86604),et=n(51674),tt=n(8716);const nt="pdLDCowVOiUIfeu9hihi",st="yuNKB15IIjFkFJbXil2H",rt="zjhp3VC76BipaXjVHuGx",ot="ge8K7iQqLE77g0FDGfDn",it="iqDYHLUedgX8y1eM1zep",at=e=>{const{canScrollLeft:t,canScrollRight:n,onClick:s}=e;return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(et._,{label:a.ag.get("carousel.left"),children:(0,X.jsx)(tt.E,{disabled:!t,size:"sm",onClick:()=>{s("previous")},icon:Xe.e,ariaLabel:a.ag.get("carousel.left"),tabIndex:-1,className:it})}),(0,X.jsx)(et._,{label:a.ag.get("carousel.right"),children:(0,X.jsx)(tt.E,{disabled:!n,size:"sm",onClick:()=>{s("next")},icon:Qe.V,ariaLabel:a.ag.get("carousel.right"),tabIndex:-1,className:it})})]})};var lt=n(24697),ct=n(86706);const ut=e=>{const{containerRef:t,onScrollEnd:n}=e,r=(0,ct.v9)((e=>e.ui?.textDirection?.isRTL?"rtl":"ltr")),[o,i]=(0,s.useState)({canScrollLeft:!1,canScrollRight:!0}),{canScrollLeft:a,canScrollRight:l}=o,c=(0,lt.y1)((()=>{i(function(e){let t=!1,n=!1;if(e.current){const{scrollLeft:s,offsetWidth:r,scrollWidth:o}=e.current,i=Math.abs(s);t=i>0,n=i+r<o}return{canScrollLeft:t,canScrollRight:n}}(t)),n?.()}),50);(0,s.useEffect)((()=>{const e=t.current;return e?.addEventListener("scroll",c),()=>{e?.removeEventListener("scroll",c)}}),[t,c]);return{canScrollLeft:a,canScrollRight:l,scroll:(0,s.useCallback)(((e,n)=>{let s="previous"===e?-1:1;"rtl"===r&&(s*=-1),s*=n.columnCount*n.columnWidth+n.gridGap,t.current?.scrollBy({top:0,left:s})}),[t,r])}};var mt=n(36522);const dt=s.memo((function({children:e,title:t,seeAllUri:n,pageId:r,total:i,onClickShelfTitle:a,onClickShelfSeeAll:l,onSwipe:c,onClickCarouselControls:u,elementRef:m}){const d=(0,s.useRef)(null),h=(0,s.useRef)(!1),[x,g]=(0,s.useState)({columnCount:-1,columnWidth:-1,gridGap:0}),{columnCount:p}=x,j=(0,s.useCallback)((({columnCount:t})=>t>0?e:null),[e]),{canScrollLeft:C,canScrollRight:S,scroll:y}=ut({containerRef:d,onScrollEnd:()=>{!1===h.current&&c?.(),h.current=!1}}),v=(0,s.useCallback)((e=>{h.current=!0,y(e,x),u?.(e)}),[x,u,y]),k=(0,s.useCallback)((e=>{g(e)}),[]);if(!Array.isArray(e)||0===e.length)return null;const N=i>e.length,b=e.length>p&&p>0,T={"--carousel-number-of-items":e.length};return(0,X.jsxs)("section",{ref:m,style:T,className:mt.Z.shelf,"aria-label":t,children:[(0,X.jsxs)("div",{className:o()(mt.Z.header,st),children:[(0,X.jsx)(f.r,{title:t,seeAllUri:n,pageId:r,hasMoreElements:N,onClickTitle:a,onClickSeeAll:l,className:rt}),b&&(0,X.jsx)("div",{className:ot,children:(0,X.jsx)(at,{canScrollLeft:C,canScrollRight:S,onClick:v})})]}),(0,X.jsx)($e.T,{className:o()(mt.Z.shelfGrid,nt),render:j,onLayoutChange:k,ref:d})]})}));dt.displayName="BaseCarouselShelf";const ht=e=>(0,X.jsx)(u.L,{onError:e=>{(0,d.vK)(e,"Carousel")},children:(0,X.jsx)(dt,{...e})});ht.displayName="Carousel";var xt=n(98624);const ft=({index:e,id:t,...n})=>{const{seeAllUri:s}=n,{onClickShelfTitle:r,onClickShelfSeeAll:o,onSwipe:i,onClickCarouselControls:a,elementRef:l,UBIWrapper:c}=(0,xt.e)({seeAllUri:s,index:e,id:t});return(0,X.jsx)(c,{children:(0,X.jsx)(ht,{...n,onClickShelfTitle:r,onClickShelfSeeAll:o,onSwipe:i,onClickCarouselControls:a,elementRef:l})})};var gt=n(18686),pt=n(30343);const jt=({spec:e,section:t,index:n})=>{const r=(0,Fe.W6)(Me.ty,{loadingValue:!1})?ft:gt.q;return(0,s.useMemo)((()=>t.sectionItems.items.some((e=>(0,pt.d)(e.content)))),[t.sectionItems])?(0,X.jsx)(ie.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(r,{total:t.sectionItems.totalCount,seeAllUri:t.uri,pageId:t.uri,title:t.data.title?.text??"",index:n,id:t.uri,children:t.sectionItems.items.map(pt.x)})}):null};var Ct=n(56607);const St=({spec:e,section:t,index:n})=>(0,X.jsx)(ie.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(Ct.default,{title:t.data.title?.text??void 0,showAll:!1,index:n})});var yt=n(28791);const vt=({spec:e,greeting:t,section:n})=>(0,X.jsx)(ie.Nh,{spec:e.shortcutsFactory(),children:(0,X.jsx)(_e,{items:n.sectionItems.items.map(yt.lh),title:t??void 0})}),kt=(0,s.lazy)((async()=>{const{FeatureActivationShelf:e}=await Promise.all([n.e(1814),n.e(8228)]).then(n.bind(n,7106));return{default:e}})),Nt=({spec:e,greeting:t,section:n,index:s})=>{switch(n.data?.__typename){case"HomeGenericSectionData":return(0,X.jsx)(jt,{spec:e,section:(0,Ye.f)(n,n.data),index:s});case"HomeFeatureActivationSectionData":return(0,Ve.wW)()?(0,X.jsx)(kt,{}):null;case"HomeShortsSectionData":return(0,X.jsx)(vt,{spec:e,greeting:t,section:(0,Ye.f)(n,n.data)});case"HomeRecentlyPlayedSectionData":return(0,X.jsx)(St,{spec:e,section:(0,Ye.f)(n,n.data),index:s});case"HomeFeedBaselineSectionData":case"HomeNativeAdsSectionData":case"HomeOnboardingSectionData":case null:case void 0:return null;default:return(0,Je._)(n.data),null}},bt=({spec:e,greeting:t,container:n})=>{const{spec:r,logger:o}=(0,ie.fU)(qe.createDesktopHomeFeatureActivationShelfEventFactory,{});return(0,s.useEffect)((()=>{(0,Ke.wW)()&&o.logImpression(r.impressionElementFactory().impression())}),[r,o]),(0,X.jsx)(X.Fragment,{children:n.sections.items.map(((n,s)=>(0,X.jsx)(Nt,{spec:e,greeting:t,section:n,index:s},`${s}-${n.uri}`)))})};var Tt=n(69756),Lt=n(60653);const Et=(0,s.memo)((({cardCount:e})=>(0,X.jsx)(Lt.X,{isLoading:!0,children:[...new Array(e).keys()].map(((e,t)=>(0,X.jsx)(Tt.A,{isLoading:!0},t)))})));var _t=n(76728);const wt=6,Pt=6,Bt=6,It=(0,s.memo)((({shortcutCount:e,shelfCount:t,cardCount:n})=>(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:_t.Z.home,children:(0,X.jsxs)("div",{className:o()(_t.Z.content,"contentSpacing"),children:[(0,X.jsx)(Re,{shortcutCount:e}),[...new Array(t).keys()].map(((e,t)=>(0,X.jsx)(Et,{cardCount:n},t)))]})})}))),At=({spec:e})=>{(0,De.z)("home");const{data:t,error:n,loading:s}=(0,We.b3)({timeZone:(0,Ze.L7)()},{cacheTime:Ze.us,staleTime:Ze.fS});if(s)return(0,X.jsx)(It,{shortcutCount:wt,shelfCount:Pt,cardCount:Bt});if(null!==n)return(0,X.jsx)(Oe.h,{hasError:!0,errorMessage:a.ag.get("error.generic")});const r=t?.home;return"HomeResponsePayload"!==r?.__typename||0===r.sectionContainer.sections.totalCount||0===r.sectionContainer.sections.items.length?(0,X.jsx)(Oe.h,{hasError:!0,errorMessage:a.ag.get("error.generic")}):(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:_t.Z.home,children:(0,X.jsx)("div",{className:o()(_t.Z.content,"contentSpacing"),children:(0,X.jsx)(bt,{spec:e,greeting:r.greeting?.text??null,container:r.sectionContainer})})})})},Ut=()=>{const{spec:e}=(0,ie.fU)(i.createDesktopHomeEventFactory,{data:{identifier:"home",uri:"spotify:home"}});return(0,X.jsxs)(ie.Nh,{spec:e,children:[(0,X.jsx)(l.$,{children:a.ag.get("page.generic-title")}),(0,X.jsx)(s.Suspense,{fallback:null,children:(0,X.jsx)(Ge,{})}),(0,X.jsx)(At,{spec:e})]})}}}]);
//# sourceMappingURL=home-v2.js.map